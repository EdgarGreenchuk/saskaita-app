<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redaguoti SÄ…skaitÄ…</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/invoice-form.css">
    <link rel="stylesheet" href="../css/modal.css">
</head>
<body>
    <button class="dark-mode-toggle no-print" id="dark-mode-toggle">ğŸŒ™</button>
    
    <header>
        <h1>âœï¸ Redaguoti SÄ…skaitÄ…</h1>
        <p>Atnaujinkite sÄ…skaitos informacijÄ…</p>
    </header>

    <nav>
        <a href="../index.html" class="nav-btn">ğŸ  PradÅ¾ia</a>
        <a href="invoices.html" class="nav-btn">ğŸ“‹ SÄ…skaitÅ³ SÄ…raÅ¡as</a>
        <button onclick="cancelEdit()" class="nav-btn" style="background: #999;">âœ– AtÅ¡aukti</button>
    </nav>

    <main>
        <div class="loading" id="loading">Kraunama...</div>
        
        <form id="invoice-form" style="display: none;">
            <!-- PagrindinÄ— informacija -->
            <section class="form-section">
                <h2>ğŸ“‹ SÄ…skaitos Informacija</h2>
                
                <div style="display: flex; gap: 20px;">
                    <div class="form-group" style="flex: 1;">
                        <label for="invoice_number">SÄ…skaitos numeris *</label>
                        <input type="text" id="invoice_number" required>
                    </div>

                    <div class="form-group" style="flex: 1;">
                        <label for="invoice_date">SÄ…skaitos data *</label>
                        <input type="date" id="invoice_date" required>
                    </div>

                    <div class="form-group" style="flex: 1;">
                        <label for="due_date">MokÄ—jimo terminas *</label>
                        <input type="date" id="due_date" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="status">Statusas</label>
                    <select id="status">
                        <option value="unpaid">NeapmokÄ—ta</option>
                        <option value="paid">ApmokÄ—ta</option>
                        <option value="overdue">UÅ¾delsta</option>
                    </select>
                </div>
            </section>

            <!-- Klientas -->
            <section class="form-section">
                <h2>ğŸ‘¥ Klientas</h2>
                
                <div style="display: flex; gap: 10px; align-items: end;">
                    <div class="form-group" style="flex: 1;">
                        <label for="client_id">Pasirinkite klientÄ… *</label>
                        <select id="client_id" required>
                            <option value="">-- Pasirinkite klientÄ… --</option>
                        </select>
                    </div>
                    <button type="button" class="btn" onclick="openAddClientModal()" style="margin-bottom: 20px;">+ Naujas Klientas</button>
                </div>

                <div id="client-details" style="display: none; padding: 15px; background: #E8D5C4; border-radius: 5px; margin-top: 10px;">
                    <p><strong>Ä®monÄ—:</strong> <span id="client-company"></span></p>
                    <p><strong>Kodas:</strong> <span id="client-code"></span></p>
                    <p><strong>PVM:</strong> <span id="client-vat"></span></p>
                    <p><strong>Adresas:</strong> <span id="client-address"></span></p>
                </div>
            </section>

            <!-- PrekÄ—s -->
            <section class="form-section">
                <h2>ğŸ“¦ PrekÄ—s / Paslaugos</h2>
                
                <div id="items-container"></div>
                
                <div style="display: flex; gap: 10px;">
                    <button type="button" class="btn" id="add-item-btn">+ PridÄ—ti PrekÄ™</button>
                    <button type="button" class="btn" onclick="openAddProductModal()">+ Naujas Produktas</button>
                </div>
            </section>

            <!-- Transportavimas -->
            <section class="form-section">
                <h2>ğŸšš Transportavimas</h2>
                
                <div class="form-group">
                    <label for="shipping_price">Transportavimo kaina (EUR)</label>
                    <input type="number" id="shipping_price" step="0.01" min="0" value="0">
                </div>
            </section>

            <!-- Sumos -->
            <section class="form-section totals-section">
                <h2>ğŸ’° Sumos</h2>
                
                <div class="totals-display">
                    <div class="total-row">
                        <span>Suma be PVM:</span>
                        <strong id="subtotal-display">0.00 â‚¬</strong>
                    </div>
                    <div class="total-row">
                        <span>PVM (21%):</span>
                        <strong id="vat-display">0.00 â‚¬</strong>
                    </div>
                    <div class="total-row grand-total">
                        <span>VISO SU PVM:</span>
                        <strong id="total-display">0.00 â‚¬</strong>
                    </div>
                </div>
            </section>

            <div style="text-align: center; margin-top: 30px;">
                <button type="submit" class="btn" style="font-size: 1.3em; padding: 15px 50px;">
                    âœ… IÅ¡saugoti Pakeitimus
                </button>
            </div>
        </form>
    </main>

    <!-- Modal Overlay -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModals()"></div>

    <!-- Add Client Modal -->
    <div class="modal" id="add-client-modal">
        <button class="modal-close" onclick="closeModals()">Ã—</button>
        <h2>Naujas Klientas</h2>
        
        <form id="quick-add-client-form">
            <div class="form-group">
                <label for="modal-company-name">Ä®monÄ—s pavadinimas *</label>
                <input type="text" id="modal-company-name" required>
            </div>

            <div style="display: flex; gap: 15px;">
                <div class="form-group" style="flex: 1;">
                    <label for="modal-company-code">Ä®monÄ—s kodas</label>
                    <input type="text" id="modal-company-code">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="modal-vat-code">PVM kodas</label>
                    <input type="text" id="modal-vat-code">
                </div>
            </div>

            <div class="form-group">
                <label for="modal-address">Adresas</label>
                <input type="text" id="modal-address">
            </div>

            <div style="display: flex; gap: 15px;">
                <div class="form-group" style="flex: 2;">
                    <label for="modal-city">Miestas</label>
                    <input type="text" id="modal-city">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="modal-postal-code">PaÅ¡to kodas</label>
                    <input type="text" id="modal-postal-code">
                </div>
            </div>

            <div style="display: flex; gap: 15px;">
                <div class="form-group" style="flex: 1;">
                    <label for="modal-email">El. paÅ¡tas</label>
                    <input type="email" id="modal-email">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="modal-phone">Telefonas</label>
                    <input type="tel" id="modal-phone">
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn" onclick="closeModals()" style="background: #999;">AtÅ¡aukti</button>
                <button type="submit" class="btn">IÅ¡saugoti KlientÄ…</button>
            </div>
        </form>
    </div>

    <!-- Add Product Modal -->
    <div class="modal" id="add-product-modal">
        <button class="modal-close" onclick="closeModals()">Ã—</button>
        <h2>Naujas Produktas</h2>
        
        <form id="quick-add-product-form">
            <div class="form-group">
                <label for="modal-product-name">Produkto pavadinimas *</label>
                <input type="text" id="modal-product-name" required>
            </div>

            <div class="form-group">
                <label for="modal-product-description">ApraÅ¡ymas</label>
                <textarea id="modal-product-description" rows="3"></textarea>
            </div>

            <div style="display: flex; gap: 15px;">
                <div class="form-group" style="flex: 2;">
                    <label for="modal-product-price">Kaina (EUR) *</label>
                    <input type="number" id="modal-product-price" step="0.01" min="0" required>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="modal-product-unit">Vienetas</label>
                    <select id="modal-product-unit">
                        <option value="vnt">vnt</option>
                        <option value="kg">kg</option>
                        <option value="m">m</option>
                        <option value="mÂ²">mÂ²</option>
                        <option value="val">val</option>
                    </select>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn" onclick="closeModals()" style="background: #999;">AtÅ¡aukti</button>
                <button type="submit" class="btn">IÅ¡saugoti ProduktÄ…</button>
            </div>
        </form>
    </div>

    <footer>
        <p>Â© 2026 Edgar's Invoice System</p>
    </footer>
    <script src="js/config.js"></script>
    <script src="../js/edit-invoice.js"></script>
    <script src="../js/dark-mode.js"></script>
</body>
</html>